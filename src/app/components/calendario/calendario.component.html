<div class="container">
  <!-- ENCABEZADO DE LOS DÍAS -->
  <div class="days-header">
    <ng-container *ngFor="let day of daysShows; let i = index">
      <div class="container-head">
        <div class="stats-group">
          <div class="stat-item">
            <span class="stat-label">Inicial</span>
            <span class="stat-value">{{ day.inicial | currency }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Estimado</span>
            <!-- <span class="stat-value accent">{{ day.estimate | currency }}</span> -->
            <input type="number" style="width: 100%" [value]="day.estimate"
              (keyup.enter)="onAddValue($event, 'estimate')" min="0" />
          </div>
        </div>

        <div class="stats-group">
          <div class="stat-item">
            <span class="stat-label">Confirmado</span>
            <!-- <span class="stat-value">{{ day.confirmado | currency }}</span> -->
            <input type="number" style="width: 100%" [value]="day.confirmado"
              (change)="onAddValue($event, 'confirmado')" min="0" />
          </div>
          <div class="stat-item">
            <span class="stat-label">Final Est.</span>
            <span class="stat-value">{{ day.finalEstimado | currency }}</span>
          </div>
        </div>
        <div class="final-stat">
          <span class="stat-label">Final Real</span>
          <span class="stat-value final">{{ day.finalReal | currency }}</span>
        </div>
        <div class="day-container">
          <span class="day-name">{{ daysOfWeek[i] }}</span>
        </div>

        <mat-form-field appearance="outline" class="department-select">
          <mat-label>Departamento</mat-label>
          <mat-select [value]="day.selection" (selectionChange)="onFilterByDepartment(day, $event.value)">
            @for (food of onGetDepartaments(day.day); track food) {
            <mat-option [value]="food">{{ food }}</mat-option>
            }
          </mat-select>
          <mat-hint align="end">
            Total de folios {{ day.folios.length }}</mat-hint>
        </mat-form-field>
      </div>
    </ng-container>
  </div>

  <!-- GRID DE DÍAS -->
  <div class="days-grid">
    <div class="day-cell" *ngFor="let day of daysShows" (dragover)="onDragOver($event)"
      (drop)="onDrop($event, day.day)">
      <!-- CABECERA DEL DÍA -->
      <div class="day-header">
        <div class="day-date">
          <span class="date-number">{{ day.day.getDate() }}</span>
        </div>
        <div class="day-estimate">
          <span class="estimate-label">Total en el dia</span>
          <span class="estimate-value">{{ day.finalDia | currency }}</span>
        </div>
      </div>

      <!-- DIVIDER -->
      <div class="header-divider"></div>

      <!-- LISTA DE CARDS -->
      <div class="folio-list">
        <app-card *ngFor="let folio of day.folios" [status]="day.status" [dataCard]="folio" [fromDate]="day.day"
          [onAction]="onRemove.bind(this, folio, day.day)"></app-card>
      </div>
    </div>
  </div>

  <!-- MENSAJE SI SELECCIONA UN DÍA -->
  <div class="empty" *ngIf="daySelect">
    <button (click)="daySelect = undefined" mat-icon-button class="close-btn">
      <mat-icon fontIcon="close"></mat-icon>
    </button>
    <div class="empty-content">
      <mat-icon class="empty-icon">calendar_today</mat-icon>
      <span class="empty-date">{{ daySelect.day | date : "longDate" }}</span>
    </div>
  </div>
</div>